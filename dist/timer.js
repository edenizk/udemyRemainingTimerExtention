(()=>{let e,t=[],r=[];const c=()=>document.querySelector('[data-purpose="curriculum-section-container"]').outerHTML,n=(c=!0)=>{const n=c?r:t;if(!n.length)return{error:!0,text:"No section found.\nBe sure that you are at the udemy course tab and you started the course"};let s=0;n.forEach((e=>{const t=e.querySelector("div");e.querySelector("span").getAttribute("data-checked")||t.click()}));let o=c?e.querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]'):n[0].querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]');if(!o.length)return{error:!0,text:"No items found, be sure that sections are opened"};try{o.forEach((e=>{if(!e.querySelector('input[data-purpose="progress-toggle-button"]').checked){let t=e.querySelector('[class^="curriculum-item-link--bottom-row"] span');if(t){const e=parseInt(t.innerHTML.replace("min",""));s+=isNaN(e)?0:e}}}));return{error:!1,hours:Math.floor(s/60),minutes:s%60}}catch(e){return{error:!0,text:`Something went wrong please create an issue at <a href="https://github.com/edenizk/udemyRemainingTimerExtention/issues/new" target="_blank">https://github.com/edenizk/udemyRemainingTimerExtention/issues/new</a>. Error msg ${JSON.stringify(e)}`}}},s=(e,t)=>{if(!e||e.error)return t.classList.add("error"),void(t.innerHTML=e?e.text:"Something went wrong ðŸ˜¿");t.classList.remove("error"),t.innerHTML=`${e.hours}:${e.minutes}H Left`};chrome.tabs.query({active:!0,currentWindow:!0},(o=>{const i=o[0],u=document.querySelector(".whole-course"),a=document.querySelector(".current-section"),l=document.querySelector("#timer");l.innerHTML="Calculating...",u.addEventListener("click",(()=>{if(u.classList.contains("active"))return;u.classList.add("active"),a.classList.remove("active");const e=n();s(e,l)})),a.addEventListener("click",(()=>{if(a.classList.contains("active"))return;a.classList.add("active"),u.classList.remove("active");const e=n(!1);s(e,l)})),chrome.scripting.executeScript({target:{tabId:i.id},func:c},(c=>{const o=c[0].result,i=new DOMParser;e=i.parseFromString(o,"text/html"),(e=>{r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]");const c=e.querySelector('[class*="curriculum-item-link--is-current--"]');t=c?[c.closest("[data-purpose]")]:[]})(e);const u=n();s(u,l)}))}))})();