(()=>{let e,t=[],r=[];async function o(){return document.querySelector('[data-purpose="curriculum-section-container"]').outerHTML}function n(o=!0){let n=[];if(n=o?r:t,console.log("tempSections",n),!n.length)return{error:!0,text:"No section found.\nBe sure that you are at the udemy course tab and you started the course"};let c=0;n.forEach((e=>{const t=e.querySelector("div");e.querySelector("span").getAttribute("data-checked")||t.click()}));let s=[];if(s=o?e.querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]'):n[0].querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]'),!s.length)return{error:!0,text:"No items found, be sure that sections are opened"};try{s.forEach((e=>{if(!e.querySelector('input[data-purpose="progress-toggle-button"]').checked){let t=e.querySelector('[class^="curriculum-item-link--bottom-row"] span');t&&(time=t.innerHTML.replace("min",""),c+=parseInt(time))}}));return{error:!1,hours:Math.floor(c/60),minutes:c%60}}catch(e){return{error:!0,text:'Something went wrong please create an issue at <a href="https://github.com/edenizk/udemyRemainingTimerExtention/issues/new" target="_blank">https://github.com/edenizk/udemyRemainingTimerExtention/issues/new</a>. Error msg'+JSON.stringify(e)}}}const c=(e,t)=>e?e.error?(t.classList.add("error"),void(t.innerHTML=e?e.text:"something went wrong ðŸ˜¿")):(t.classList.remove("error"),void(t.innerHTML=`${e.hours}:${e.minutes}H Left`)):(t.classList.add("error"),void(t.innerHTML="Couldn't calculate try to open extension again"));chrome.tabs.query({active:!0,currentWindow:!0},(s=>{const i=s[0],l=document.querySelector(".whole-course"),u=document.querySelector(".current-section"),a=document.querySelector("#timer");a.innerHTML="Calculating...",l.addEventListener("click",(()=>{if(console.log("button clicked 1"),l.classList.contains("active"))return;l.classList.add("active"),u.classList.remove("active");const e=n();console.log("val",e),console.log("sections",r),c(e,a)})),u.addEventListener("click",(()=>{if(console.log("button clicked 2"),u.classList.contains("active"))return;u.classList.add("active"),l.classList.remove("active");const e=n(!1);console.log("sections",t),console.log("val",e),c(e,a)})),chrome.scripting.executeScript({target:{tabId:i.id},func:o},(o=>{const s=o[0].result;console.log("panel",s);const i=new DOMParser;e=i.parseFromString(s,"text/html"),function(e){r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]");const o=e.querySelector('[class*="curriculum-item-link--is-current--"]');o&&(t=[o.closest("[data-purpose]")])}(e);const l=n();console.log("time",l),c(l,a)}))}))})();