(()=>{let e,t=[],r=[];const c=()=>{const e=document.querySelector('[data-purpose="curriculum-section-container"]');return r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]"),r.forEach((e=>{console.log("section",e);const t=e.querySelector("div");e.querySelector("span").getAttribute("data-checked")||t.click()})),e.outerHTML},s=(c=!0)=>{const s=c?r:t;if(!s.length)return{error:!0,text:"No section found.\nBe sure that you are at the udemy course tab and you started the course"};let o=0,i=c?e.querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]'):s[0].querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]');if(!i.length)return{error:!0,text:"No items found, be sure that sections are opened"};try{i.forEach((e=>{if(!e.querySelector('input[data-purpose="progress-toggle-button"]').checked){let t=e.querySelector('[class^="curriculum-item-link--bottom-row"] span');if(t){const e=parseInt(t.innerHTML.replace("min",""));o+=isNaN(e)?0:e}}}));return{error:!1,hours:Math.floor(o/60),minutes:o%60}}catch(e){return{error:!0,text:`Something went wrong please create an issue at <a href="https://github.com/edenizk/udemyRemainingTimerExtention/issues/new" target="_blank">https://github.com/edenizk/udemyRemainingTimerExtention/issues/new</a>. Error msg ${JSON.stringify(e)}`}}},o=(e,t)=>{if(!e||e.error)return t.classList.add("error"),void(t.innerHTML=e?e.text:"Something went wrong ðŸ˜¿");t.classList.remove("error"),t.innerHTML=`${e.hours}:${e.minutes}H Left`};chrome.tabs.query({active:!0,currentWindow:!0},(i=>{const n=i[0],a=document.querySelector(".timer-section"),u=document.querySelector(".timer-section-button"),l=document.querySelector(".playback-section"),m=document.querySelector(".playback-section-button"),d=document.querySelector(".whole-course"),p=document.querySelector(".current-section"),v=document.querySelector("#timer");v.innerHTML="Calculating...",d.addEventListener("click",(()=>{if(d.classList.contains("active"))return;d.classList.add("active"),p.classList.remove("active");const e=s();o(e,v)})),p.addEventListener("click",(()=>{if(p.classList.contains("active"))return;p.classList.add("active"),d.classList.remove("active");const e=s(!1);o(e,v)})),console.log("timer",a),console.log("playback",l),console.log("timerSectionButton",u),console.log("playbackButton",m),u.addEventListener("click",(()=>{u.classList.contains("active")||(a.classList.add("active"),u.classList.add("active"),l.classList.remove("active"),m.classList.remove("active"))})),m.addEventListener("click",(()=>{m.classList.contains("active")||(l.classList.add("active"),m.classList.add("active"),a.classList.remove("active"),u.classList.remove("active"))})),chrome.scripting.executeScript({target:{tabId:n.id},func:c},(c=>{if(!c||!c.length)return;const i=c[0].result,n=new DOMParser;e=n.parseFromString(i,"text/html"),(e=>{r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]");const c=e.querySelector('[class*="curriculum-item-link--is-current--"]');t=c?[c.closest("[data-purpose]")]:[]})(e);const a=s();o(a,v)}))}))})();