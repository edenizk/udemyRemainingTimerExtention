(()=>{let e,t=[],r=[];const c=()=>{const e=document.querySelector('[data-purpose="curriculum-section-container"]');return r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]"),r.forEach((e=>{console.log("section",e);const t=e.querySelector("div");e.querySelector("span").getAttribute("data-checked")||t.click()})),e.outerHTML},o=(c=!0)=>{const o=c?r:t;if(!o.length)return{error:!0,text:"No section found.\nBe sure that you are at the udemy course tab and you started the course"};let n=0,s=c?e.querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]'):o[0].querySelectorAll('[data-purpose^="curriculum-item-"][class*="item-link--common--"]');if(!s.length)return{error:!0,text:"No items found, be sure that sections are opened"};try{s.forEach((e=>{if(!e.querySelector('input[data-purpose="progress-toggle-button"]').checked){let t=e.querySelector('[class^="curriculum-item-link--bottom-row"] span');if(t){const e=parseInt(t.innerHTML.replace("min",""));n+=isNaN(e)?0:e}}}));return{error:!1,hours:Math.floor(n/60),minutes:n%60}}catch(e){return{error:!0,text:`Something went wrong please create an issue at <a href="https://github.com/edenizk/udemyRemainingTimerExtention/issues/new" target="_blank">https://github.com/edenizk/udemyRemainingTimerExtention/issues/new</a>. Error msg ${JSON.stringify(e)}`}}},n=(e,t)=>{if(!e||e.error)return t.classList.add("error"),void(t.innerHTML=e?e.text:"Something went wrong ðŸ˜¿");t.classList.remove("error"),t.innerHTML=`${e.hours}:${e.minutes}H Left`};chrome.tabs.query({active:!0,currentWindow:!0},(s=>{const i=s[0],u=document.querySelector(".whole-course"),a=document.querySelector(".current-section"),l=document.querySelector("#timer");l.innerHTML="Calculating...",u.addEventListener("click",(()=>{if(u.classList.contains("active"))return;u.classList.add("active"),a.classList.remove("active");const e=o();n(e,l)})),a.addEventListener("click",(()=>{if(a.classList.contains("active"))return;a.classList.add("active"),u.classList.remove("active");const e=o(!1);n(e,l)})),chrome.scripting.executeScript({target:{tabId:i.id},func:c},(c=>{const s=c[0].result,i=new DOMParser;e=i.parseFromString(s,"text/html"),(e=>{r=e.querySelectorAll("[data-purpose=curriculum-section-container] > [data-purpose]");const c=e.querySelector('[class*="curriculum-item-link--is-current--"]');t=c?[c.closest("[data-purpose]")]:[]})(e);const u=o();n(u,l)}))}))})();